jobs:
  include:
    # - stage: Tests
    #   name: "Kourou Lint"
    #   language: node_js
    #   node_js: 12
    #   cache:
    #     directories:
    #       - ~/.npm
    #       - ~/.cache
    #       - node_modules # NPM packages

    #   install:
    #     - npm install --silent --unsafe-perm
    #     - npm install --silent --unsafe-perm --only=dev

    #   script:
    #     - npm run test:lint

    # - stage: Tests
    #   name: "Kourou Functional Stdout Tests"
    #   language: node_js
    #   node_js: 12
    #   cache:
    #     directories:
    #       - ~/.npm
    #       - ~/.cache
    #       - node_modules # NPM packages

    #   install:
    #     - npm install --silent --unsafe-perm
    #     - npm install --silent --unsafe-perm --only=dev

    #   script:
    #     - npm run test:functional:stdout

    # - stage: Tests
    #   name: "Kourou Functional Cucumber Tests"
    #   language: node_js
    #   node_js: 12
    #   cache:
    #     directories:
    #       - ~/.npm
    #       - ~/.cache
    #       - node_modules # NPM packages

    #   install:
    #     - npm install --silent --unsafe-perm
    #     - npm install --silent --unsafe-perm --only=dev

    #   script:
    #     - bash features/run-kuzzle-stack.sh
    #     - npm run test:functional:cucumber

    - stage: Deploy
      name: Deploy Kourou on NPM
      if: type = push AND branch = master
      sudo: false
      language: node_js
      node_js: 12
      install:
        - npm install
      deploy:
        provider: npm
        skip_cleanup: true
        email: support@kuzzle.io
        api_key:
          secure: "JBREVHZdyifFh+tc1R5olUClFedAW4FtYZqSC3Kc3tMcIsCcfJx07PmCOBtc71LjKLUR2jL4Fy4T98t877pNjAOCmmhUzUnr85XRglDcbJKdm5bmM6AyolqfOZeHt1MMnqwZsQHzeIuHTWy+BvIlZbsENqkDnAUwJ1FB+gvCdGUbsVCzvS18NAfB4S8r/1aYJNB2bzugHwIOdc+tO175pAvrKrrhqk3Hdklq4Vho4J2x1UdDm9Eoct0qzSUP3r8xHz1SQmy+pbYtxi0LlKzO6kTKYuuIA7JeUXbxPsEd93QOeP39qdxboagxeW8+1NgBHDJ0Adq+1lJcvel21bCDL0el2emZfLWWDUymVEhREVtNvABPo42r5Od4BwK10roFmXdGxvdQ0R3erYQi/O5/tkyE2S+tp6qy2eDdg4wbjpS+aSK6ppLazcOhPDFNcZ1KOk0p5OB9/eFTR02zXFcOEo2+YdPc/sg8xw6LBa0gMj0YA9MrnHWDZkhov8jZrDRwupN/mnEq9f1hGdjrBFkv275aVH5NwzJ1M/1B3voAtjfEu2+9VNAgmkcb2ECTQFXsVusvRMWLbLkvfzFbdgRBsnM+/BcQss8RDgzR9NmQhlyRoCTUf5enzd3wgukJoNSiKeccaXckd+tG3zYTIHafNFhQoxTlne/kz1bC2FYrX7c="
        on:
          repo: kuzzleio/kourou
          all_branches: true
